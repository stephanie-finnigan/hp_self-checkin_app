@model SelfCheckinWebApp.ViewModels.BookingViewModel
@using SelfCheckinWebApp.Enums
@{
    ViewBag.Title = "Complete Check-In";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var mode = ViewBag.Mode;
    var newContact = ViewBag.newContact;
    var featureSwitchValues = ViewBag.FeatureSwitchValues;
    var tAndCLink = featureSwitchValues[FeatureSwitchEnum.TCHotelLink];
}

<div class="bkg-info">
    <div class="bkg-ref">
        @Html.LabelFor(model => model.BookingID)
        @Html.DisplayFor(model => model.BookingID)
    </div>
    @if (!string.IsNullOrEmpty(mode))
    {
        <div class="bkg-rm">
            @Html.LabelFor(model => model.FirstNightRoomNo)
            @Html.DisplayFor(model => model.FirstNightRoomNo)
        </div>
    }
</div>
<hr />

@using (Html.BeginForm("CompleteCheckIn", "CheckIn", FormMethod.Post, new { @class = "marktg-final form-horizontal" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    @Html.HiddenFor(model => model.BookingID)

    @Html.HiddenFor(model => model.Contact.MarketingPermissionSought)

    if (newContact == null)
    {
        <div class="gdpr-title">
            <h4>MARKETING PREFERENCES</h4>
            <p>We will use the information you provide on this form to stay in touch with special offers and marketing communications.</p>
        </div>
        <div class="row-gdpr">
            <div class="col-xs-12 col-md-12">
                @for (int i = 0; i < Model.Contact.MarketingPreferences.Count; i++)
                {
                    <div class="checkbox-inline">
                        @Html.CheckBoxFor(model => model.Contact.MarketingPreferences[i].PrefSelected)
                        @Html.LabelFor(model => model.Contact.MarketingPreferences[i].PrefSelected, Model.Contact.MarketingPreferences[i].Description)
                        @Html.HiddenFor(model => model.Contact.MarketingPreferences[i].Description)
                        @Html.HiddenFor(model => model.Contact.MarketingPreferences[i].CodeField)
                    </div>
                }
            </div>
        </div>
        <div class="gdpr-info">
            <p>
                You may change your marketing preferences at any time by clicking unsubscribe in the emails you receive from us or by contacting the hotel by email<email address of hotel>.<br />
                We will treat your information with respect. For information about our privacy practices please visit our website.<br />
                By selecting these options, you agree that we may process your information in accordance with these terms.
            </p>
        </div>
    }
    <div class="terms-agree">
        <div class="form-group">
            <div class="checkbox-inline">
                @Html.CheckBoxFor(model => model.TermsAgree, new { @id = "termsAgree" })
                <label class="control-label" id="termsLabel">I Agree to Hotel <a href="@tAndCLink">Terms & Conditions</a></label>
                <br />
                @Html.ValidationMessageFor(model => model.TermsAgree, "", new { @class = "text-danger" })
            </div>
        </div>
    </div>
    <hr />
    <footer>
        <div class="back-btn">
            @Html.ActionLink("Back", "BookingExtras", "CheckIn", new { @class = "btn btn-primary" })
        </div>
        <div class="proceed-btn">
            <input type="submit" value="Check In" class="btn btn-primary" />
        </div>
    </footer>
}